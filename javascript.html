<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>


  <script>

    // function extrairPassos(dados) {

    // const passosHex = dados.slice(10, 15);
    // console.log(passosHex)

    // let decimal = 0;

    // for (let i = 0; i < passosHex.length; i++) {
    // Converte cada valor hexadecimal em decimal e soma ao total
    // decimal += parseInt(passosHex[i], 16) * Math.pow(256, passosHex.length - 1 - i);
    // }

    // return decimal;
    // }
    //                            0     1       2      3       4       5       6       7       8       9      10     11       12     13     14
    // Sua array de valores hexadecimais                                                                   '0x00', '0x00', '0x09', '0x69', '0x00'
    // const arrayCompleta = ['0xcd', '0x00', '0x11', '0x15', '0x01', '0x0c', '0x00', '0x0c', '0x00', '0x00', '0x00', '0x00', '0x09', '0x69', '0x00', '0x00', '0x08', '0x7a', '0x00', '0x28'];

    // Chame a função para obter o número de passos
    // const numeroDePassos = extrairPassos(arrayCompleta);

    // Exiba o número de passos no console
    // console.log('Número de Passos:', numeroDePassos);







    // function hexToDecimal(hex) {
    // const hexArray = hex.split(' '); // Divide a string hex em um array
    // let decimal = 0;

    // for (let i = 0; i < hexArray.length; i++) {
    // Converte cada valor hexadecimal em decimal e soma ao total
    // decimal += parseInt(hexArray[i], 16) * Math.pow(256, hexArray.length - 1 - i);
    // }

    // return decimal;
    // }

    // Exemplo de uso:
    // const hexString = '0x00 0x00 0x09 0x69 0x00';
    // const decimalValue = hexToDecimal(hexString);
    // console.log('Valor Decimal:', decimalValue);









    // function hexToDecimal(hexString) {
    //   const hexArray = hexString.split(' '); // Divide a string hex em um array
    //   let decimalValue = 0;

    //   for (let i = 0; i < hexArray.length; i++) {
    //     // Converte cada valor hexadecimal em decimal e acumula no valor final
    //     const hexValue = parseInt(hexArray[i], 16);
    //     decimalValue += hexValue * Math.pow(256, hexArray.length - 1 - i);
    //   }

    //   return decimalValue;
    // }

    // // Exemplo de uso:
    // const hexString = '0x00 0x09 0x69 0x00';
    // const decimalValue = hexToDecimal(hexString);
    // console.log('Valor Decimal:', decimalValue);


    function hexToDecimalArray(hexVetor) {

      const hexArray = hexVetor
      let decimalValue = 0;

      for (let i = 0; i < hexArray.length; i++) {
        // Converte cada valor hexadecimal em decimal e acumula no valor final
        const hexValue = parseInt(hexArray[i], 16);
        decimalValue += hexValue * Math.pow(256, hexArray.length - 1 - i);
      }

      return decimalValue;
    }


    function hexToDecimal(hexString) {

      const hexArray = hexString.split(' '); // Divide a string hex em um array
      let decimalValue = 0;

      for (let i = 0; i < hexArray.length; i++) {
        // Converte cada valor hexadecimal em decimal e acumula no valor final
        const hexValue = parseInt(hexArray[i], 16);
        decimalValue += hexValue * Math.pow(256, hexArray.length - 1 - i);
      }

      return decimalValue;
    }

    function obterDiaSemana(numeroDia) {
      // Implemente uma função para converter o número do dia da semana em um nome de dia.
      // Por exemplo: 1 -> "Dom", 2 -> "Seg", etc.
      // Você pode usar um array de nomes de dia ou outra abordagem que preferir.
      // Esta função depende da estrutura de dados que você deseja usar.
      // Aqui está um exemplo simples usando um array:
      const diasDaSemana = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
      return diasDaSemana[numeroDia] || 'Desconhecido';
    }




    //                            0     1       2      3        4       5       6       7       8       9      10     11       12     13     14
    // Sua array de valores hexadecimais
    // const arrayCompleta = ['0xcd', '0x00', '0x11', '0x15', '0x01', '0x0c', '0x00', '0x0c', '0x00', '0x00', '0x00', '0x00', '0x09', '0x69', '0x00', '0x00', '0x08', '0x7a', '0x00', '0x28'];

    // const arrayCompleta = ['0xcd', '0x00', '0x11', '0x15', '0x01', '0x0c', '0x00', '0x0c', '0x00', '0x00', '0x00', '0x00', '0x09', '0x69', '0x00', '0x00', '0x08', '0x7a', '0x00', '0x28'];

    // for (let i = 0; i < arrayCompleta.length; i++) {
    //   for (let j = i + 1; j <= arrayCompleta.length; j++) {
    //     const trecho = arrayCompleta.slice(i, j);
    //     const hexString = trecho.join(' ');
    //     const decimalValue = hexToDecimal(hexString);

    //     if (decimalValue === 2409) {
    //       console.log('Trecho que resulta em 2409:', trecho);
    //       console.log('Valor Decimal:', decimalValue);
    //     }
    //   }
    // }


    function parseDadosRecebidos(hexValues, decimalValues) {
      if (hexValues.length < 20) {
        // Certifique-se de que a matriz de dados tenha pelo menos 20 elementos para conter todas as informações.
        return null;
      }

      let dados = decimalValues

      // CORRETO!
      const pressaoArterial = `${decimalValues[18]}/${decimalValues[17]}`;
      const batimentosPorMinuto = decimalValues[19];
      const saturacaoOxigenio = `${decimalValues[16]}%`;

      const diaSemana = obterDiaSemana(decimalValues[4]); // Função para converter o número do dia da semana.


      // converter de hexadecimal pra decimal
      let arrayCompleta = hexValues;
      const trecho = arrayCompleta.slice(11, 14);
      const hexString = trecho.join(' ');
      const decimalValue = hexToDecimal(hexString);
      const passos = decimalValue;









      const horaAtual = `${dados[5]}:${dados[6]}`;
      const dataAtual = `${dados[8]}/${dados[7]}`;

      const distanciaKm = dados[15] + (dados[16] / 10); // Combinar dois bytes e dividir por 10 para obter a distância em quilômetros.
      const temperatura = dados[17];

      const objetoInformacoes = {
        pressaoArterial,
        saturacaoOxigenio,
        batimentosPorMinuto,
        horaAtual,
        diaSemana,
        dataAtual,
        passos,
        distanciaKm,
        temperatura
      };

      return objetoInformacoes;
    }


    console.log(
      parseDadosRecebidos(
        ['0xcd', '0x00', '0x11', '0x15', '0x01', '0x0c', '0x00', '0x0c', '0x00', '0x00', '0x00', '0x00', '0x09', '0x69', '0x00', '0x00', '0x08', '0x7a', '0x00', '0x28'],
        [205, 0, 17, 21, 1, 14, 0, 12, 47, 87, 0, 1, 0, 0, 205, 139, 99, 96, 127, 95]))









    // ['0xcd', '0x00', '0x11', '0x15',
    // '0x01', = dia semana
    // '0x0c', '0x00', '0x0c',
    // '0x00', '0x00', '0x00',
    //  '0x00', '0x09', '0x69', = passos

    //  '0x00', '0x00',

    //  '0x08', '0x7a', '0x00', '0x28']; = coracao






    //                                                           ds                                                      passos                                   oxig         arterial           bpm
    //                            0     1       2      3        [4]       5       6       7       8       9      10     [11       12     13]      14        15    [16]         [17      18]        [19]
    // Sua array de valores hexadecimais
    // const arrayCompleta = ['0xcd', '0x00', '0x11', '0x15', '0x01', '0x0c', '0x00', '0x0c', '0x00', '0x00', '0x00', '0x00', '0x09', '0x69', '0x00', '0x00', '0x08', '0x7a', '0x00', '0x28'];
    //                        [205,     0,     17,      21,    1,       14,     0,      12,     47,     87,     0,      1,     0,      0,       205,   139,    99,     96,     127,    95]

    // ['0xcd', '0x00', '0x11', '0x15']
    // ['0x0c', '0x00', '0x0c', '0x00', '0x00', '0x00']
    // ['0x00', '0x00']

    // console.log(hexToDecimal('0x0c 0x00'))


    function forEachSubarray(arr, callback) {
      function generateSubarrays(subarray, index) {
        if (index === arr.length) {
          callback(subarray);
          return;
        }

        // Inclui o próximo elemento na subarray
        generateSubarrays(subarray.concat(arr[index]), index + 1);

        // Exclui o próximo elemento da subarray
        generateSubarrays(subarray, index + 1);
      }

      generateSubarrays([], 0);
    }

    // Exemplo de uso:

    // 0xcd e 0x11 = 52497 = 14:34 gmt

    const minhaArray = ['0x15', '0x11', '0x00', '0xcd']
    forEachSubarray(minhaArray, subarray => {


      console.log(subarray + " valor decimal: " + hexToDecimalArray(subarray));
    });



  </script>
</body>

</html>